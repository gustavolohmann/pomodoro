<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Hub de Estudo</title>
    <meta name="description" content="Veja seu progresso: tempo de estudo, dias ativos, cards revisados, streak e gr√°fico de atividade. Dashboard do Hub de Estudos.">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.godtimestudy.com.br/pages/dashboard.html">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Dashboard - Hub de Estudo">
    <meta property="og:description" content="Veja seu progresso: tempo de estudo, dias ativos, cards revisados, streak e gr√°fico de atividade. Dashboard do Hub de Estudos.">
    <meta property="og:url" content="https://www.godtimestudy.com.br/pages/dashboard.html">
    <meta property="og:image" content="https://www.godtimestudy.com.br/pomodoro.jpg">
    <meta property="og:locale" content="pt_BR">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Dashboard - Hub de Estudo">
    <meta name="twitter:description" content="Veja seu progresso: tempo de estudo, dias ativos, cards revisados, streak e gr√°fico de atividade.">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script type="application/ld+json">
    {"@context":"https://schema.org","@type":"WebApplication","name":"Dashboard - Hub de Estudo","description":"Veja seu progresso: tempo de estudo, dias ativos, cards revisados, streak e gr√°fico de atividade. Dashboard do Hub de Estudos.","url":"https://www.godtimestudy.com.br/pages/dashboard.html","applicationCategory":"EducationalApplication","offers":{"@type":"Offer","price":"0","priceCurrency":"BRL"}}
    </script>
    <script type="application/ld+json">
    {"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Hub","item":"https://www.godtimestudy.com.br/pages/index.html"},{"@type":"ListItem","position":2,"name":"Dashboard","item":"https://www.godtimestudy.com.br/pages/dashboard.html"}]}
    </script>
</head>
<body class="method-page has-top-bar dashboard-page">
    <div class="background-gradient"></div>
    <header class="top-bar">
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="index.html" data-i18n="hub">Hub</a>
            <span class="breadcrumb-separator">‚Ä∫</span>
            <span class="breadcrumb-current" data-i18n="dashboard">Dashboard</span>
        </nav>
        <span id="langSelector"></span>
    </header>

    <div class="dashboard-page-wrap">
        <div class="dashboard-inner">
            <!-- Header da Dashboard -->
            <header class="dashboard-header">
                <a href="index.html" class="back-link" data-i18n="backToHub">‚Üê Voltar ao Hub</a>
                <h1 class="dashboard-title">üìä <span data-i18n="dashboard">Dashboard</span></h1>
                <p class="dashboard-desc" data-i18n="dashboardDesc">Progresso e estat√≠sticas</p>
            </header>

            <!-- Se√ß√£o de M√©tricas -->
            <section class="dashboard-metrics" aria-label="M√©tricas">
                <div class="dashboard-metric">
                    <span class="dashboard-metric-label" data-i18n="totalMinutes">Tempo total (Pomodoro)</span>
                    <span class="dashboard-metric-value" id="totalMinutes">0</span>
                    <span class="dashboard-metric-unit" data-i18n="minutes">minutos</span>
                </div>
                <div class="dashboard-metric">
                    <span class="dashboard-metric-label" data-i18n="activeDays">Dias ativos</span>
                    <span class="dashboard-metric-value" id="activeDays">0</span>
                </div>
                <div class="dashboard-metric">
                    <span class="dashboard-metric-label" data-i18n="cardsReviewed">Cards revisados</span>
                    <span class="dashboard-metric-value" id="cardsReviewed">0</span>
                </div>
                <div class="dashboard-metric">
                    <span class="dashboard-metric-label" data-i18n="accuracy">Taxa de acerto</span>
                    <span class="dashboard-metric-value" id="accuracy">0%</span>
                </div>
                <div class="dashboard-metric">
                    <span class="dashboard-metric-label" data-i18n="streak">Streak atual</span>
                    <span class="dashboard-metric-value" id="streak">0</span>
                    <span class="dashboard-metric-unit" data-i18n="days">dias</span>
                </div>
            </section>

            <!-- Status do Pomodoro global -->
            <section class="dashboard-pomodoro-status" id="dashboardPomodoroStatus" aria-label="Pomodoro atual">
                <h2 class="dashboard-section-title">üçÖ <span data-i18n="pomodoroNow">Pomodoro atual</span></h2>
                <div class="dashboard-pomodoro-content" id="dashboardPomodoroContent">
                    <a href="pomodoro.html" class="dashboard-pomodoro-link" id="dashboardPomodoroLink">
                        <span id="dashboardPomodoroTime">25:00</span>
                        <span id="dashboardPomodoroMode" data-i18n="pomodoroMode">Pomodoro</span>
                        <span class="dashboard-pomodoro-cycle" id="dashboardPomodoroCycle">0/4</span>
                    </a>
                </div>
            </section>

            <!-- Se√ß√£o do Gr√°fico de Atividade -->
            <section class="dashboard-chart-section" aria-label="Gr√°fico de atividade">
                <h2 class="dashboard-section-title">üìà <span data-i18n="activityChart">Atividade (√∫ltimos 14 dias)</span></h2>
                <div class="dashboard-chart-content">
                    <div id="activityChart" class="dashboard-chart" role="img" aria-label="Gr√°fico de barras: dias com atividade nos √∫ltimos 14 dias"></div>
                </div>
            </section>

            <p class="seo-outros-links" style="margin-top: 1.5rem;">Outros m√©todos de estudo: <a href="index.html">Hub</a>, <a href="pomodoro.html">Pomodoro</a>, <a href="flashcards.html">Flashcards</a>, <a href="mapa-mental.html">Mapa Mental</a>.</p>
            <div class="dashboard-footer">
                <a href="index.html" class="btn btn-primary" data-i18n="backToHub">Voltar ao Hub</a>
            </div>
        </div>
    </div>

    <script src="../lang/pt-BR.js"></script>
    <script src="../lang/en.js"></script>
    <script src="../lang/es.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/pomodoro.js"></script>
    <script src="../js/pomodoro-header.js"></script>
    <script src="../js/hub-data.js"></script>
    <script src="../js/modal.js"></script>
    <script>
        function loadDashboard() {
            var log = HubData.getActivityLog();
            var dates = log.dates || [];
            var pomodoroMinutes = log.pomodoroMinutes || 0;
            var cardsReviewed = log.cardsReviewed || 0;
            var correctCount = log.correctCount || 0;
            var totalMinutesVal = pomodoroMinutes;
            try {
                var pomodoroStats = localStorage.getItem('pomodoroStatistics');
                if (pomodoroStats) {
                    var s = JSON.parse(pomodoroStats);
                    totalMinutesVal += (s.totalCount || 0) * 25;
                }
            } catch (e) {}
            document.getElementById('totalMinutes').textContent = totalMinutesVal;
            document.getElementById('activeDays').textContent = dates.length;
            document.getElementById('cardsReviewed').textContent = cardsReviewed;
            document.getElementById('accuracy').textContent = cardsReviewed ? Math.round((correctCount / cardsReviewed) * 100) + '%' : '0%';
            var dateSet = new Set(dates);
            var streak = 0;
            if (dates.length > 0) {
                var dayOffset = 0;
                while (true) {
                    var d = new Date();
                    d.setUTCDate(d.getUTCDate() - dayOffset);
                    var key = d.toISOString().slice(0, 10);
                    if (!dateSet.has(key)) break;
                    streak++;
                    dayOffset++;
                }
            }
            document.getElementById('streak').textContent = streak;
            renderActivityChart(dateSet);
            updateDashboardPomodoro();
        }
        function updateDashboardPomodoro() {
            if (!window.PomodoroEngine) return;
            var s = window.PomodoroEngine.getState();
            var m = Math.floor(s.remaining / 60);
            var sec = s.remaining % 60;
            var timeStr = (m < 10 ? '0' : '') + m + ':' + (sec < 10 ? '0' : '') + sec;
            var modeNames = { pomodoro: (window.I18n && window.I18n.t('pomodoroMode')) || 'Pomodoro', shortBreak: (window.I18n && window.I18n.t('shortBreak')) || 'Pausa Curta', longBreak: (window.I18n && window.I18n.t('longBreak')) || 'Pausa Longa' };
            var cycle = (s.completedCycles || 0) + '/' + (s.cyclesForLongBreak || 4);
            var elTime = document.getElementById('dashboardPomodoroTime');
            var elMode = document.getElementById('dashboardPomodoroMode');
            var elCycle = document.getElementById('dashboardPomodoroCycle');
            if (elTime) elTime.textContent = timeStr;
            if (elMode) elMode.textContent = modeNames[s.mode] || 'Pomodoro';
            if (elCycle) elCycle.textContent = cycle;
            var block = document.getElementById('dashboardPomodoroStatus');
            if (block) block.style.display = '';
        }
        document.addEventListener('pomodoro:update', function() { updateDashboardPomodoro(); });
        function renderActivityChart(dateSet) {
            var dayLabels = [];
            var dayKeys = [];
            for (var i = 13; i >= 0; i--) {
                var d = new Date();
                d.setUTCDate(d.getUTCDate() - i);
                var key = d.toISOString().slice(0, 10);
                dayKeys.push(key);
                var dayNum = d.getUTCDate();
                var short = d.toLocaleDateString(document.documentElement.lang || 'pt-BR', { weekday: 'short' });
                dayLabels.push(short + ' ' + dayNum);
            }
            var chartEl = document.getElementById('activityChart');
            if (!chartEl) return;
            var bars = dayKeys.map(function(key, idx) {
                var active = dateSet.has(key);
                var title = dayLabels[idx] + (active ? ' \u2713' : '');
                return '<div class="dashboard-chart-bar-wrap" title="' + title + '"><div class="dashboard-chart-bar' + (active ? ' active' : '') + '" style="height:' + (active ? '100' : '8') + '%"></div><span class="dashboard-chart-label">' + dayLabels[idx].split(' ')[0] + '</span></div>';
            });
            chartEl.innerHTML = '<div class="dashboard-chart-bars">' + bars.join('') + '</div>';
        }
        loadDashboard();
    </script>
</body>
</html>
